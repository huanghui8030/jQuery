<!DOCTYPE html>
<html data-livestyle-extension="available">
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
		<title>图文对比-标尺</title>
		<link rel="stylesheet" type="text/css" href="./js/index.css">
		<script src="./js/jquery-2.1.0.js"></script>
		<script src="./js/data.js"></script>
		<script src="./js/handleImage.js"></script>
		<script src="./js/index.js"></script>
<style>
.contrastOuter{
   position: relative;
/*
    width: 100%;
    height: 100%;
    background: #000;
    opacity: 0.3;
    box-sizing: border-box;
*/
}
.contrastBlock{
    width:50%;
    height: 40px;
    border:1px solid #ccc;
    position: absolute;
    top:100px;
    left:0;
    background: #c72365;
    opacity: 0.35;
    cursor: move; 
    box-sizing: border-box;
    -webkit-box-shadow: 0px 0px 5px 1px #fff; 
            box-shadow: 0px 0px 5px 1px #fff; 
}
.contrastLeft{
    width: calc(100% - 710px);
}
.contrastRight{
    width: 700px;
    left: calc(100% - 700px)
}
/*.contrastClose{
    position: absolute;
    top: 4px;
    right: 2px;
    width: 30px;
    height: 30px;
    display: block;
    font-size: 24px;
    font-weight: bold;
    color: #fff;
    cursor: pointer;
    text-align: center;
    -webkit-user-select:none;
       -moz-user-select:none;
            user-select:none; 
}*/
.bc-input{width:40px;}
.rcdb-table{font-size: 14px;margin:10px 4px;}
.rcdb-table tr{height: 40px;line-height: 40px;}
.input-short{width:32px;}
.input-long{width:100px;}
.btn{border: 1px solid #ccc;background: #d9ece9;padding: 2px 6px;cursor: pointer;margin-left: 0px;}
    .input-short,.input-long{height: 30px;line-height: 30px;padding:0 2px;}
</style>
	</head>
	<body>
		<div class="container1" style="width: 1440px; height: 683px;">
			<div class="main1">
				<!-- 图片显示 -->
				<div class="showImg1" style="height: 538px;">
					<a href="javascript:;" class="showImg1_btnLeft"></a>
					<a href="javascript:;" class="showImg1_btnRight"></a>
					<div class="imgBox1">
						<img src="" class="img1" style="width: 400px; height: 266px; left: 293px; top: 156px;">
					</div>
				</div>
				<!-- 图片选择 -->
				<div class="chooseImg1_box">
					<div class="navList1">
						<!--<span class="btnImgList">图片列表<i></i></span>-->
						<lable class="pTroName1" style='margin-right: 20px;'></lable>
						<span class="btnImgScale">
							<a href="javascript:;" class="scaleAdd1">+</a>
							<b class="scale1">100%</b>
							<a href="javascript:;" class="scaleReduce1">-</a>
						</span>
						<span class="btnImgInit1">原始尺寸</span>
                        <span class="btnContrast">标尺</span>
                        
                        <span class="btnImgScale contrastHeight left">
							<a href="javascript:;" class="add">+</a>
							<b class="scale">100%</b>
							<a href="javascript:;" class="reduce">-</a>
						</span>
				        <span class='contrast-left'>还原left</span>
				       
				        <span class="btnImgScale contrastHeight right">
							<a href="javascript:;" class="add">+</a>
							<b class="scale">100%</b>
							<a href="javascript:;" class="reduce">-</a>
						</span>
				        <span class='contrast-right'>还原right</span>
				        
					</div>
					<div class="boxLimit1">
						<a href="javascript:;" class="chooseImg1_btnLeft"></a>
						<div class="imgListBox1">
							<ul class="imgList1" style="width: 1610px; left: 0px;">
								<!--<li></li>
								<li class="active"></li>-->
							</ul>
						</div>
						<a href="javascript:;" class="chooseImg1_btnRight"></a>
					</div>
					
				</div>
			</div>
			<div class="sider1">
				<p class="pTroTit1">images/a2.jpg</p>
				<p class="pTroName1">a2.jpg</p>
				<div class='rcdb-table'>
				    <table>
				        <tr>
                            <td>1.</td>
                            <td>课程：<input type="text" value='体育基础课' class='input-long'></td>
                            <td>分数：<input type="text" value='84' class='input-short'></td>
                            <td>学分：<input type="text" value='1' class='input-short'></td>
                            <td>学时：<input type="text" value='' class='input-short'></td>
                            <td>课程类别：<select name="kclb" id="">
                                <option value="1">必修</option>
                                <option value="2">选修</option>
                            </select></td>
                            <td><input type="button" value='删除' class='btn'></td>
				        </tr><tr>
                            <td>2.</td>
                            <td>课程：<input type="text" value='体育基础课' class='input-long'></td>
                            <td>分数：<input type="text" value='84' class='input-short'></td>
                            <td>学分：<input type="text" value='1' class='input-short'></td>
                            <td>学时：<input type="text" value='' class='input-short'></td>
                            <td>课程类别：<select name="kclb" id="">
                                <option value="1">必修</option>
                                <option value="2">选修</option>
                            </select></td>
                            <td><input type="button" value='删除' class='btn'></td>
				        </tr><tr>
                            <td>3.</td>
                            <td>课程：<input type="text" value='体育基础课' class='input-long'></td>
                            <td>分数：<input type="text" value='84' class='input-short'></td>
                            <td>学分：<input type="text" value='1' class='input-short'></td>
                            <td>学时：<input type="text" value='' class='input-short'></td>
                            <td>课程类别：<select name="kclb" id="">
                                <option value="1">必修</option>
                                <option value="2">选修</option>
                            </select></td>
                            <td><input type="button" value='删除' class='btn'></td>
				        </tr><tr>
                            <td>4.</td>
                            <td>课程：<input type="text" value='体育基础课' class='input-long'></td>
                            <td>分数：<input type="text" value='84' class='input-short'></td>
                            <td>学分：<input type="text" value='1' class='input-short'></td>
                            <td>学时：<input type="text" value='' class='input-short'></td>
                            <td>课程类别：<select name="kclb" id="">
                                <option value="1">必修</option>
                                <option value="2">选修</option>
                            </select></td>
                            <td><input type="button" value='删除' class='btn'></td>
				        </tr><tr>
                            <td>5.</td>
                            <td>课程：<input type="text" value='体育基础课' class='input-long'></td>
                            <td>分数：<input type="text" value='84' class='input-short'></td>
                            <td>学分：<input type="text" value='1' class='input-short'></td>
                            <td>学时：<input type="text" value='' class='input-short'></td>
                            <td>课程类别：<select name="kclb" id="">
                                <option value="1">必修</option>
                                <option value="2">选修</option>
                            </select></td>
                            <td><input type="button" value='删除' class='btn'></td>
				        </tr><tr>
                            <td>6.</td>
                            <td>课程：<input type="text" value='体育基础课' class='input-long'></td>
                            <td>分数：<input type="text" value='84' class='input-short'></td>
                            <td>学分：<input type="text" value='1' class='input-short'></td>
                            <td>学时：<input type="text" value='' class='input-short'></td>
                            <td>课程类别：<select name="kclb" id="">
                                <option value="1">必修</option>
                                <option value="2">选修</option>
                            </select></td>
                            <td><input type="button" value='删除' class='btn'></td>
				        </tr><tr>
                            <td>7.</td>
                            <td>课程：<input type="text" value='体育基础课' class='input-long'></td>
                            <td>分数：<input type="text" value='84' class='input-short'></td>
                            <td>学分：<input type="text" value='1' class='input-short'></td>
                            <td>学时：<input type="text" value='' class='input-short'></td>
                            <td>课程类别：<select name="kclb" id="">
                                <option value="1">必修</option>
                                <option value="2">选修</option>
                            </select></td>
                            <td><input type="button" value='删除' class='btn'></td>
				        </tr><tr>
                            <td>8.</td>
                            <td>课程：<input type="text" value='体育基础课' class='input-long'></td>
                            <td>分数：<input type="text" value='84' class='input-short'></td>
                            <td>学分：<input type="text" value='1' class='input-short'></td>
                            <td>学时：<input type="text" value='' class='input-short'></td>
                            <td>课程类别：<select name="kclb" id="">
                                <option value="1">必修</option>
                                <option value="2">选修</option>
                            </select></td>
                            <td><input type="button" value='删除' class='btn'></td>
				        </tr><tr>
                            <td>9.</td>
                            <td>课程：<input type="text" value='体育基础课' class='input-long'></td>
                            <td>分数：<input type="text" value='84' class='input-short'></td>
                            <td>学分：<input type="text" value='1' class='input-short'></td>
                            <td>学时：<input type="text" value='' class='input-short'></td>
                            <td>课程类别：<select name="kclb" id="">
                                <option value="1">必修</option>
                                <option value="2">选修</option>
                            </select></td>
                            <td><input type="button" value='删除' class='btn'></td>
				        </tr><tr>
                            <td>10.</td>
                            <td>课程：<input type="text" value='体育基础课' class='input-long'></td>
                            <td>分数：<input type="text" value='84' class='input-short'></td>
                            <td>学分：<input type="text" value='1' class='input-short'></td>
                            <td>学时：<input type="text" value='' class='input-short'></td>
                            <td>课程类别：<select name="kclb" id="">
                                <option value="1">必修</option>
                                <option value="2">选修</option>
                            </select></td>
                            <td><input type="button" value='删除' class='btn'></td>
				        </tr>
				    </table>
				</div>
			</div>
		</div>
<script>
var INITHEIGHT = 40;
$(function(){ 
    showContrast();
    moveContrast()
    
    $(document).keydown(function(e){  //键盘事件
        if(e.keyCode == 38 && e.shiftKey){ //shift+up
            setContrastMove(0);
        }else if(e.keyCode == 40 && e.shiftKey ){ //shift+down
            setContrastMove(1);
        }else if(e.keyCode == 76 && e.shiftKey){ //shift+l
            setContrastMove(2);
        }else if(e.keyCode == 82 && e.shiftKey){ //shift+r
            setContrastMove(3);
        }
    });  
})
/**
 * 显示标尺
 * @author huangh@chsi.com.cn 20170602
 */
function showContrast(){
    $('.navList1').delegate('.btnContrast','click',function(){
        var $contrast = $('.contrastOuter') || '' ,
            $contariner = $('.container1');
        if($contrast.length==0){
            $contariner.append('<div class="contrastOuter"><div class="contrastLeft contrastBlock"></div><div class="contrastRight contrastBlock"></div></div>');
        }else{
            return false;
            /*$contrast.show();
            $('.contrastBlock').css('top','100px');*/
        }   
    }).delegate('.contrastHeight','click',function(e){
        if($('.contrastOuter').length==0){
            return false;
        }
        var $target = $(e.target) ,
            $this = $(this) ,
            addIndex = 0 ,
            leftIndex = 0 ,
            text = '' ; 
        if($this.is('.left')){
            leftIndex = 0 ;
        }else if($this.is('.right')){
            leftIndex = 1 ;
        }  
        if($target.is('.add')){
            addIndex = 0 ;
            text = $this.find('.scale').text() ;
            setContrastHeight(addIndex,leftIndex,text) ; 
        }else if($target.is('.reduce')){
            addIndex = 1 ; 
            text = $this.find('.scale').text() ;
            setContrastHeight(addIndex,leftIndex,text) ; 
        }
    }).delegate('.contrast-left','click',function(){
        if($('.contrastOuter').length==0){
            return false;
        }
        $('.contrastLeft').css('height',INITHEIGHT);
        $('.left').find('.scale').text('100%');
    }).delegate('.contrast-right','click',function(){
        if($('.contrastOuter').length==0){
            return false;
        }
        $('.contrastRight').css('height',INITHEIGHT);
        $('.right').find('.scale').text('100%');
    });   
}
/**
 * 设置标尺高等
 * @param {Number} addIndex  0加，1减
 * @param {Number} leftIndex 0左，1右
 * @author huangh@chsi.com.cn 20170606
 */
function setContrastHeight(addIndex,leftIndex,text){
    var n = parseInt(text) ,
        MULTIPLE = 20 ,
        MAXN = 300,
        MINN = 100;
    if(addIndex===0){
        n += MULTIPLE ;
    }else if(addIndex===1){
        n -= MULTIPLE ;
    }
    n = n<MINN?MINN:n;
    n = n>MAXN?MAXN:n;
    if(leftIndex===0){
        $('.contrastLeft').height(parseInt(n*INITHEIGHT/100));
        $('.left').find('.scale').text(n+"%");
    }else if(leftIndex===1){
        $('.contrastRight').height(parseInt(n*INITHEIGHT/100));
        $('.right').find('.scale').text(n+"%");
    }
};
/**
 * 移动左右标尺
 * @author huangh@chsi.com.cn 20170602
 */
function moveContrast(){
    var y1 = 0 ,  //移动前位置
        y2 = 0 ,  //移动后位置
        MoveFlag = false; //是否移动
    $('.container1').delegate('.contrastBlock','mousedown',function(e){
        MoveFlag = true;
        var $this = $(this),
            top = parseFloat($this.css('top')).toFixed(0.2);
        y1 = e.pageY;
       
    }).delegate('div','mouseup',function(e){
        MoveFlag = false;
    }).delegate('.contrastBlock','mousemove',function(e){
        if(MoveFlag){
            var $this = $(this),
                top = parseInt($this.css('top')),
                height = $(window).height() - $this.height() -5;
            y2 = e.pageY;
            top +=  y2-y1;
            top = top<5?5:top;
            top = top>height?height:top;
            $this.css('top',top+"px");
             y1 = y2;
            window.getSelection ? window.getSelection().removeAllRanges() : document.selection.empty(); 
        }
    })
   /* .delegate('.contrastClose','click',function(){
        MoveFlag = false;
        $('.contrastOuter').hide();
    });*/
}
/**
 * 设置标尺一起移动
 * @param {Number} dir 标尺移动方向，0标尺一起往上，1标尺一起往下，2左边标尺往下走，3右边标尺往下走。
 * @author huangh@chsi.com.cn 20170606
 */
function setContrastMove(dir){
    var $left = $('.contrastLeft'),
        $right = $('.contrastRight'),
        left = parseInt($left.css('top')),
        right = parseInt($right.css('top')),
        cLeftHeight = $('.contrastLeft').height(),
        cRightHeight = $('.contrastRight').height(),
        height = $(window).height() - (cLeftHeight>cRightHeight?cRightHeight:cLeftHeight) -5;
    if(dir === 0){
        left -= INITHEIGHT ;  
        right -= INITHEIGHT ;  
    }else if(dir === 1){
        left += INITHEIGHT ;  
        right += INITHEIGHT ;  
    }else if(dir === 2){
        left += INITHEIGHT ;  
        right = right;
    }else if(dir === 3){  
        left = left;
        right += INITHEIGHT ;  
    }
    left = left<5?5:left;
    right = right<5?5:right;
    left = left>height?height:left;
    right = right>height?height:right;
    $left.css('top',left);
    $right.css('top',right);
}
</script>
</body>
</html>










